<!-- #tag layout_block('bodyContent') -->
<div class="container container-lt" ng-controller="indexCtrl">
    <div class="panel panel-default">
        <div class="panel-heading clearfix">
            <span class="pull-left">选择您的项目</span>
            <a href="#" class="pull-right" ng-click="addProject()"><i class="fa fa-plus" ></i> 添加</a >
        </div>
        <div class="list-group">
            <a href="#" class="list-group-item clearfix" ng-repeat="project in projects" ng-click="enter(project)" ng-cloak>
                <span class="pull-left"><span ng-bind="project.name"></span>（<span ng-bind="project.code"></span>）</span>
                <span class="pull-right"><i class="fa fa-angle-double-right"></i></span>
            </a>
            <span class="list-group-item text-warning" ng-if="projects.length===0"><i class="fa fa-exclamation-triangle"></i> 尚未添加过项目</span>
        </div>
    </div>
</div>

<script type="text/javascript">
    'use strict';
    function indexCtrl($scope, $http) {
        angular.extend($scope, {
            // 初始化
            init: function() {
                $scope.findProjects();
            },

            // 查询所有项目
            findProjects: function() {
                $http({
                    method: 'get',
                    url: '${app}/projects'
                }).success(function(data) {
                    $scope.projects = data;
                });
            },

            // 进入项目页面
            enter: function(project) {
                window.location.href = '${app}/project/' + project.id;
            },

            // 进入添加项目页面
            addProject: function(project) {
                window.location.href = '${app}/project/config/add';
            }


        }).init();
    }
</script>
<!-- #end -->
<!-- #include('layout.html') -->
