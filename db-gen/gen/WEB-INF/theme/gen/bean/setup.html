<div ng-controller="setupCtrl">
    <div class="panel panel-default panel-tab">
        <div class="panel-body">
            <form name="beanForm" method="post" action="#" class="form-horizontal" ng-submit="beanFunc.save($event)">
                <div class="form-group">
                    <label class="col-sm-2 control-label"><i class="text-danger">*</i> 名称</label>
                    <div class="col-sm-4">
                        <input type="text" name="name" class="form-control" ng-model="beanFormData.name" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label"><i class="text-danger">*</i> 代码</label>
                    <div class="col-sm-4">
                        <input type="text" name="code" class="form-control" ng-model="beanFormData.code" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">包名</label>
                    <div class="col-sm-6">
                        <input type="text" name="packageName" class="form-control" ng-model="beanFormData.packageName">
                    </div>
                </div>
                <div class="form-group margin-bottom-zero">
                    <div class="col-sm-offset-2 col-sm-10">
                        <button class="btn btn-success"><i class="fa fa-floppy-o"></i> 保存</button>
                        <button type="button" class="btn btn-danger" ng-click="beanFunc.delete()"><i class="fa fa-times"></i> 删除</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<script type="text/javascript">
    'use strict';
    function setupCtrl($scope, $http) {
        angular.extend($scope, {
            // 初始化
            init: function() {
                $scope.beanFormData = angular.extend({}, $scope.current.bean, {_request_type: 'json'});
                $scope.deleteProps($scope.beanFormData, 'creator', 'createTime', 'updater', 'updateTime');
            },

            // 对象方法集合
            beanFunc: {
                // 保存
                save: function($event) {
                    $scope.stop($event);
                    $http({
                        method: 'put',
                        url: '${app}/bean/update/' + $scope.beanFormData.id,
                        data: $scope.beanFormData
                    }).success(function(data) {
                        console.log(data);
                        $scope.updateFromArray(data.data, $scope.beans);
                    });
                },

                // 删除
                delete: function() {
                    $http({
                        method: 'delete',
                        url: '${app}/bean/delete/' + $scope.beanFormData.id
                    }).success(function(data) {
                        console.log(data);
                        $scope.removeFromArray(data.data, $scope.beans);
                    });
                }
            }
        }).init();
    }
</script>